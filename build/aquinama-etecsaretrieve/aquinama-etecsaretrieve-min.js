YUI.add("aquinama-etecsaretrieve",function(B){B.namespace("AquiNaMa");var A=B.Base.create("aquinama-etecsaretrieve",B.Base,[],{initializer:function(E){var C=this,D;C.set("model",E.model);C._publishEvents();},_publishEvents:function(){var C=this;C.publish("categoryRetrieve",{emitFacade:true,broadcast:1});C.publish("articleRetrieve",{emitFacade:true,broadcast:1});C.publish("error",{emitFacade:true,broadcast:1});},getData:function(E){var D=this,C;if(E.length>0){B.each(E,function(F){C=D.get("model").getAttr("attr",F);if(C){if(D[C]){D[F.attr](F.value,E);}else{D.fire("activeRetrieve:error",{data:{error:"No existe una funcion definida para el filtro "+C}});}}else{D.fire("activeRetrieve:error",{data:{error:"El filtro: "+F+" no tiene la propiedad attr definida"}});}});}else{D.fire("activeRetrieve:error",{data:{error:"No hay filtros definidos"}});}},getCategory:function(E){var D=this,F,C;D.on("categoryRetrieve",function(G){F=D.get("model").getAttr("data",G);if(F){C=D.categoryParse(G.data);D.fire("activeRetrieve:categoryRetrieve",{data:C});}else{D.fire("activeRetrieve:error",{data:{error:"CategoryRetrieve no ha retornado ningun dato"}});}});if(E){D.categoryRetrieve(E);}else{return false;}},categoryRetrieve:function(E){var C=this,F,D;B.Get.js(E,function(G){if(G){C.fire("activeRetrieve:error",{data:{error:G[0].error}});return;}C.fire("categoryRetrieve",{data:pepe});});},categoryParse:function(E){var D=this,C=new B.ModelList(),H,F=1;try{B.each(E,function(I){H=D.articleOutParse(I,F);C.add(H);F++;});}catch(G){D.fire("activeRetrieve:error",{data:{error:"La data no es la que se esperaba:"+G}});}return C;},categoryFormat:function(C){return C;},articleOutParse:function(I,G){var C=this,D="",F="",E="";try{D=I;E=I.split(", ");E=parseInt(E[1]);return new B.Model({tittle:D,price:E,number:G});}catch(H){C.fire("activeRetrieve:error",{data:{error:"Imposible parsear este articulo: "+H}});}return false;},category:function(E,F){var C=this,D="";D="script/"+C.get("model").getAttr(E).url+".js";C.getCategory(D);}},{ATTRS:{model:{value:{}},count:{value:100}}});B.AquiNaMa.EtecsaRetrieve=A;},"@VERSION@",{skinnable:false,requires:["base","event","get"]});