YUI.add("aquinama-cubretrieve",function(E){E.namespace("AquiNaMa");var B="activeRetrieve:error",A="urlBase",F="totalPages",D="more",C=E.Base.create("aquinama-cubretrieve",E.AquiNaMa.UrlRetrieve,[],{initializer:function(G){},categoryParse:function(I){var H=this,G=new E.ModelList(),K,J;K={metaFields:{pages:"result.span"},resultListLocator:"result.div",resultFields:[{key:"date",locator:"div[1].p",parser:H.categoryDateParse},{key:"tittle",locator:"div[2].p.a.u"},{key:"href",locator:"div[2].p.a.href"},{key:"price",locator:"div[2].p.content",parser:H.categoryPriceParse}],filterRecord:H.filterRecord,container:G,context:H};J=E.DataSchema.JSON.apply(K,I);try{H.categoryPagesCountParse(J.meta.pages);if(J.results<1){}else{H.fire(B,{data:{error:"No fue encontrado ningun articulo"}});}}catch(L){return K.container;}return K.container;},filterRecord:function(H,K){var G=this,J,I;I=[G.get(A),H.href];I=I.join("");J=new E.AquiNaMa.ArticleModel({interest:false,idAttribute:"href",open:false,load:false,tittle:H.tittle,price:H.price,href:I,date:H.date,number:0,highlight:H.tittle,retrieve:"CubRetrieve"});G.addTarget(J);K.container.add(J);return H;},categoryPagesCountParse:function(H){var G=this,I=0;if(!G.get(D)){I=H;if(I){I=parseInt(I[I.length-1].content);G.set("totalArticle",I*50);}else{I=0;}G.set(F,I);}},articleParse:function(M){var N=this,G,J="",K={},H,O=[],I;try{O.push(M.result);H={resultFields:[{key:"desc",locator:"span[0].content",parser:N.articleDescriptionParse},{key:"name",locator:"span[1].content"},{key:"phone",locator:"span[2].content"},{key:"cell",locator:"span[3].content"},{key:"site",locator:"span[4].content"},{key:"address",locator:"span[5].content"}]};I=E.DataSchema.JSON.apply(H,O);I=I.results[0];J=I.desc;if(!J){J=N.articleDescriptionParse(M.result.span.content);}delete I.desc;K=I;return{date:G,desc:J,contact:K};}catch(L){}return{date:G,desc:J,contact:K};},articleDateParse:function(H){var G,I=H.div[0].div;if(E.Lang.isArray(I)){G=I[1].span[1].content;}else{if(I.span[1].content){G=I.span[1].content;}else{return false;}}return G;},articleDescriptionParse:function(H){try{H=H.split("(Anuncio publicado");return H[0];}catch(G){}return H;},categoryDateParse:function(I){var O=new Date(),N="",J="",K="",L="",H="",G="";try{N=I.split("/");H=N[0];if(N.length>1){H=E.Lang.trim(H);G=parseInt(N[1])-1;O=new Date(N[2],G,H);}else{N=H.split(":");J=E.Lang.trim(N[0]);N=N[1].split(" ");K=N[0];L=E.Lang.trim(N[1]);if(L==="pm"){J=parseInt(J);J+=12;}O.setHours(J);O.setMinutes(K);}return O;}catch(M){}return O;},categoryPriceParse:function(G){try{G=G.split(" cuc ");if(G.length>0){G=E.Lang.trim(G[0]);}G=parseFloat(G);if(!E.Lang.isNumber(G)){return 0;}else{return G;}}catch(H){return 0;}},text:function(I,H){var G;G=I.split(" ").join("-");return G+"/";},nextUrl:function(I,G,H){var J=[G,I,"/"];J=J.join("");return J;}},{ATTRS:{}});E.AquiNaMa.CubRetrieve=C;},"@VERSION@",{skinnable:false,requires:["base","yql","model-list","aquinama-articlemodel","datatype-date","aquinama-urlretrieve"]});