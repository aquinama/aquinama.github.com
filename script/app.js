YUI().use("event","aquinama-datacontroller","aquinama-revolretrieve","aquinama-literal","aquinama-search","aquinama-list","aquinama-tools",function(c){var b={};var a="app.revol";a=a.split(".");c.log(a);b.tree=appTree;b.model=b.tree;b.error=error;b.Search=function(d){c.one("#yui3-aquinama-news").addClass("yui3-aquinama-hidden");c.one("#yui3-aquinama-list").removeClass("yui3-aquinama-hidden");b.list.changeMoreTex("Ver mas resultados");b.list.clearList();b.filter.clear();b.list.showLoad();b.datacontroller.resetList();c.log("el filtro");c.log(d.filter);b.datacontroller.getData(d.filter);b.interest.deselect();c.one("#yui3-aquinama-error").set("innerHTML","")};b.Error=function(g){if(g.data.error.code===2){var f=b.search.get("aselect"),d=b.tree[b.search.get("aselect")];c.log("la selecionada");if(d){f=d.name}b.list.changeMoreTex(b.error[2].msg+" "+b.filter.get("query")+" "+b.list.getActiveTags()+" en "+f);b.list.hideLoad()}else{c.one("#yui3-aquinama-error").set("innerHTML","<p>"+b.error[g.data.error.code].msg)+"</p>";c.one("#yui3-aquinama-list").addClass("yui3-aquinama-hidden");b.search.clearSearch()}};b.categoryRetrieve=function(f){var d={};b.list.set("atotal",b.datacontroller.get("search.total"));b.list.set("emodellist",f.data);b.filter.set("source",b.list.source());b.filter.sendRequest();d=b.datacontroller.tags(b.search.get("aselect"));b.list.set("tags",d);b.filter.set("tags",d);b.filter.set("afilter",{});c.one("#yui3-aquinama-error").set("innerHTML","")};b.tagsHandle=function(d){b.filter.afilterPopulate(d.data);b.filter.sendRequest(b.filter.get("value"))};b.moreDataControllerHandle=function(d){b.list.set("emodellist",d.data);b.filter.set("source",b.list.source());b.filter.sendRequest(b.filter.get("query"))};b.Filter=function(d){b.list.set("evisiblelist",d.results)};b.Sort=function(d){b.filter.set("source",b.list.source());b.filter.sendRequest()};b.InterestMe=function(d){b.datacontroller.addInterest(d.model);b.interest.set("acount",b.datacontroller.get("interest").size())};b.NoInterestMe=function(d){b.datacontroller.notInterest(d.model);b.interest.set("acount",b.datacontroller.get("interest").size())};b.articleData=function(d){b.datacontroller.getData(d.data)};b.moreListHandle=function(d){b.datacontroller.more()};b.scrollDown=function(f){var d=b.body.scrollInfo.getOffscreenNodesBottom("li.yui3-aquinama-item");if(d.size()<20){b.list.moveItemsDown()}};b.search=new c.AquiNaMa.Search({boundingBox:"#yui3-aquinama-search",acategorys:b.tree});b.search.render();b.datacontroller=new c.AquiNaMa.DataController({model:b.model});b.list=new c.AquiNaMa.List({boundingBox:"#yui3-aquinama-list"});b.list.render("#yui3-aquinama-left");b.interest=new c.AquiNaMa.Interest({acount:b.datacontroller.get("interest").size(),boundingBox:c.one(".yui3-aquinama-interest"),contentBox:c.one(".yui3-aquinama-interest")});b.busqueda=new c.AquiNaMa.Busqueda({boundingBox:c.one(".yui3-aquinama-busqueda"),contentBox:c.one(".yui3-aquinama-busqueda")});b.interest.render();b.busqueda.render();b.filter=new c.AquiNaMa.Filter({inputNode:b.search.get("contentBox").one(".yui3-aquinama-search-filter"),minQueryLength:0,queryDelay:300,resultTextLocator:"tags",});b.filter.set("source",b.list.source());b.body=c.one("body");b.body.plug(c.Plugin.ScrollInfo);c.on("aquinama-search:search",b.Search);b.filter.on("results",b.Filter);c.on("aquinama-list:sort",b.Sort);c.on("aquinama-list:tags",b.tagsHandle);c.on("aquinama-datacontroller:categoryRetrieve",b.categoryRetrieve);c.on("aquinama-datacontroller:more",b.moreDataControllerHandle);c.on("aquinama-datacontroller:error",b.Error);c.on("aquinama-item:interest",b.InterestMe);c.on("aquinama-item:no-interest",b.NoInterestMe);c.on("aquinama-articlemodel:articleData",b.articleData);c.on("aquinama-list:more",b.moreListHandle);b.body.scrollInfo.on("scrollDown",b.scrollDown);c.on("aquinama-search:clear",function(d){b.list.get("boundingBox").addClass("yui3-aquinama-hidden");c.one("#yui3-aquinama-news").removeClass("yui3-aquinama-hidden");b.interest.deselect();b.list.clearList()});c.one(".yui3-aquinama-interest").on("click",function(d){b.busqueda.deselect();c.one("#yui3-aquinama-news").addClass("yui3-aquinama-hidden");c.one("#yui3-aquinama-list").removeClass("yui3-aquinama-hidden");b.list.showLoad();b.list.set("emodellist",b.datacontroller.get("interest"));b.filter.set("source",b.list.source());b.filter.clear();b.filter.sendRequest();b.search.setCategory("Me Interesan");c.one("#yui3-aquinama-error").set("innerHTML","")});c.one(".yui3-aquinama-busqueda").on("click",function(g){var d=b.datacontroller.get("latestSearch"),f=d.size();b.interest.deselect();if(f>0){b.search.setupSearch(b.search.get("lastaselect"))}else{c.one("#yui3-aquinama-news").removeClass("yui3-aquinama-hidden");b.search._syncSearch();b.search._clearSearch()}})});