YUI.add("aquinama-revolretrieve",function(E){E.namespace("AquiNaMa");var C="activeRetrieve:error",A="urlBase",B="model",D="more",F=E.Base.create("aquinama-revolretrieve",E.AquiNaMa.UrlRetrieve,[],{initializer:function(G){},categoryParse:function(O){var P=this,S=new E.ModelList(),L,G=new Date("Jan 16 1988"),I=1000,M,H,Q,J,R,N;try{M=P.get(B).getAttr("tr",O.result);if(M){R=M.length;for(J=0;J<R;J++){Q=M[J];H=P.get(B).getAttr("td",Q);if(H){N=H["class"];if(N=="adsterix_head"){G=P.categoryDateParse(H.p);}else{if(!H.hasOwnProperty("div")&&N!="space"){L=P.articleOutParse(Q,G,I);if(L){S.add(L);I--;}}}}else{}}P.categoryPagesCountParse(O);}else{P.fire(C,{data:{error:"No fue encontrado ningun articulo"}});}}catch(K){return S;}return S;},categoryPagesCountParse:function(I){var G=this,J=0,H;if(!G.get(D)){H=G.get(B).getAttr("a",I.result);if(H){J=H[1].content;J=J.split(" ");J=J[J.length-1];J=parseInt(J);G.set("totalArticle",J);J=J/100;if(J>0){J=Math.ceil(J);}}else{J=0;}G.set("totalPages",J);}},articleParse:function(M){var J=this,K=new Date(),N="",I={email:"",name:"",phone:""},H=M.result,G=[];try{K=J.articleDateParse(H);N=J.articleDescriptionParse(H);I=J.articleContactParse(H);G=J.articleImageInParse(H);return{date:K,desc:N,contact:I,images:G};}catch(L){}return{date:K,desc:N,contact:I,images:[]};},articleDateParse:function(I){var G=this,H,J=I.div[0].div;if(E.Lang.isArray(J)){H=J[1].span[1].content;}else{if(J.span[1].content){H=J.span[1].content;}else{return false;}}return H;},articleImageInParse:function(I){var H=this,J=I.img,G=[];if(J){if(E.Lang.isArray(J)){E.each(J,function(K){G.push(K.src);});}else{G.push(J.src);}}return G;},articleDescriptionParse:function(H){var I="";try{I=H.span.content;I=E.JSON.stringify(I);I=I.split("\\n");I=I.join("</br>");I=I.split("\\u000a");I=I.join("</br>");return I;}catch(G){}return I;},articleContactParse:function(K){var I=this,H,G={email:"",phone:"",name:""};try{H=K.div[1].div;if(E.Lang.isArray(H)){E.each(H,function(L){G=I.articleOneContactParse(L,G);});}else{G=I.articleOneContactParse(H,G);}return G;}catch(J){}return G;},articleOneContactParse:function(H,G){var J=H.span[0].content,I=H.span[1];J=J.split(":");J=J[0];switch(J){case"Email":G.email=I.a.content;break;case"Nombre":G.name=I.content;break;default:G.phone=I.content;break;}return G;},articleOutParse:function(P,J,K){var Q=this,M="",N="",G="",R,I,H,L="";try{I=P.td.a;M=I.content;G=I.href;H=P.td.p;if(H&&H.span){L=Q.picturesParse(H.span);}if(M===undefined||G===undefined){throw new Error("tittle or href propertys are undefined");}else{if(I.hasOwnProperty("span")){N=Q.priceParse(I.span);}else{N=0;}G=[Q.get(A),G];G=G.join("");J=new Date(J.setMilliseconds(K));R=new E.AquiNaMa.ArticleModel({interest:false,idAttribute:"href",open:false,load:false,tittle:M,price:N,href:G,date:J,number:K,highlight:M,retrieve:"RevolRetrieve",picture:L});Q.addTarget(R);return R;}}catch(O){}return false;},picturesParse:function(I){var G=this,H="";if(E.Lang.isArray(I)&&I.length>0){H=1;}return H;},categoryDateParse:function(I){var H=this,G=false,M,K,L,J;try{I=I.split(" ");J=I.length;L=I[5].split(",");G=H.get("date")[I[3]]+" "+I[1]+" "+L[0];G=new Date(G);if(J>6){M=I[J-2].split(":");K=M[1];M=parseInt(M[0]);if(I[J-1]=="PM"){M+=12;}G.setHours(M);G.setMinutes(K);}return G;}catch(N){}return G;},priceParse:function(G){try{G=G.split(" ");G=G[0].replace(",","");G=parseFloat(G);if(!E.Lang.isNumber(G)){throw new Error("El precio debe ser un numero");}else{return G;}}catch(H){return 0;}},text:function(H,G){H=escape(H);return"searchtext="+H+"&";},min:function(G,H){return"min_price="+G+"&";},max:function(G,H){return"max_price="+G+"&";},nextUrl:function(I,G,H){var J=["pagina-",I,".html?"];J=J.join("");if(H[0].attr!="category"&&H[0].attr!="article"){J="/"+J;J=G.replace(".html/?",J);}else{J=G.replace("?",J);}return J;}},{ATTRS:{}});E.AquiNaMa.RevolRetrieve=F;},"@VERSION@",{skinnable:false,requires:["base","yql","model-list","aquinama-articlemodel","datatype-date","aquinama-urlretrieve"]});