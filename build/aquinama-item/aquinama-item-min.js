YUI.add("aquinama-item",function(C){C.namespace("AquiNaMa");var B="contentBox",A=C.Base.create("aquinama-item",C.Widget,[C.WidgetChild],{CONTENT_TEMPLATE:'<li class="yui3-aquinama-item">'+'<div class="yui3-aquinama-item-title">'+'<div class="yui3-aquinama-item-control">'+'<img src="assets/images/interested.png" title="Me Interesa" class="yui3-aquinama-item-interested"/>'+'<img src="assets/images/no_interested.png" title="No Me Interesa" class="yui3-aquinama-item-no-interested"/>'+'<span class="yui3-aquinama-item-date"></span>'+'<div class="yui3-aquinama-clear"></div>'+"</div>"+'<div class="yui3-aquinama-item-data">'+"</div>"+"</div>"+'<div class="yui3-aquinama-item-container">'+'<div class="yui3-aquinama-item-container-a">'+'<img class="yui3-aquinama-item-load" src="assets/images/ajax-loader-orange.gif"/>'+'<img class="yui3-aquinama-item-close yui3-aquinama-hidden" src="assets/images/close_item.png" title="Cerrar Descripci&oacute;n"/>'+"</div>"+"</div>"+"</li>",initializer:function(){var D=this;D._publishEvents();},renderUI:function(){var D=this,E=D.get(B);},bindUI:function(){var D=this,F=D.get("emodel"),E=D.get(B);F.after("passfilterChange",D._handlerVisible,D);F.after("highlightChange",D.syncUI,D);D.after("emodelChange",D.syncUI);E.one(".yui3-aquinama-item-title").on("click",D._handlerClickEvent,D);E.on("dblclick",D._handlerCloseEvent,D);E.one("img.yui3-aquinama-item-interested").on("click",D._handlerInterestEvent,D);E.one("img.yui3-aquinama-item-no-interested").on("click",D._handlerNoInterestEvent,D);F.after("loadChange",D._syncContent,D);E.one(".yui3-aquinama-item-close").on("click",D._handlerCloseEvent,D);},syncUI:function(){var D=this,E=D.get(B),F=D.get("emodel");D._syncTitle();D._handlerVisible();if(F.get("load")){D._syncContent();}},_publishEvents:function(){var D=this;D.publish("interest",{emitFacade:true,broadcast:1});D.publish("no-interest",{emitFacade:true,broadcast:1});},_handlerInterestEvent:function(G){var D=this,E=D.get(B),F=D.get("emodel");D.fire("aquinama-item:interest",{model:F});G.stopPropagation();E.one(".yui3-aquinama-item-interested").addClass("yui3-aquinama-hidden");E.one(".yui3-aquinama-item-no-interested").removeClass("yui3-aquinama-hidden");F.set("interest",true);F.set("visible",true);D.set("model",F);D._showContent();},_handlerNoInterestEvent:function(G){var D=this,E=D.get(B),F=D.get("emodel");D.fire("aquinama-item:no-interest",{model:F});G.stopPropagation();if(D.get("parent").get("emodellist").get("name")==="interest"){E.setStyle("overflow","hidden");E.transition({easing:"ease-out",duration:0.25,height:0,on:{end:function(){D.get("parent").remove(D.get("index"));}}});}E.one(".yui3-aquinama-item-no-interested").addClass("yui3-aquinama-hidden");E.one(".yui3-aquinama-item-interested").removeClass("yui3-aquinama-hidden");F.set("interest",false);D.set("model",F);},_handlerClickEvent:function(G){var D=this,E=D.get(B),F=D.get("emodel");if(F.get("visible")){}else{F.loadContent();F.set("visible",true);D._showContent();}D.set("model",F);},_handlerCloseEvent:function(G){var D=this,E=D.get(B),F=D.get("emodel");if(F.get("visible")){D._hideContent();F.set("visible",false);}else{F.loadContent();F.set("visible",true);D._showContent();}D.set("model",F);},_handlerVisible:function(){var D=this,E=D.get("boundingBox"),F=D.get("emodel").get("passfilter");if(F){E.removeClass("yui3-aquinama-hidden");}else{E.addClass("yui3-aquinama-hidden");}},_syncTitle:function(I){var D=this,G=D.get("emodel"),E=D.get(B),H='<span class="yui3-aquinama-item-price">{price} cuc</span><span class="yui3-aquinama-item-desc">{highlight}</span><div class="yui3-aquinama-clear"></div>',F=C.DataType.Date.convert(G.get("date"));H=C.substitute(H,G.toJSON());if(G.get("interest")){E.one(".yui3-aquinama-item-interested").addClass("yui3-aquinama-hidden");E.one(".yui3-aquinama-item-no-interested").removeClass("yui3-aquinama-hidden");}else{E.one(".yui3-aquinama-item-interested").removeClass("yui3-aquinama-hidden");E.one(".yui3-aquinama-item-no-interested").addClass("yui3-aquinama-hidden");}E.one(".yui3-aquinama-item-data").set("innerHTML",H);E.one(".yui3-aquinama-item-date").set("innerHTML",F);},_syncContent:function(){var E=this,F=E.get(B),D=F.one(".yui3-aquinama-item-container-a"),H=E.get("emodel");if(D.one(".yui3-aquinama-item-load")){D.one(".yui3-aquinama-item-load").remove(true);}D.appendChild("<p>"+H.get("dateDesc")+"</p>");D.appendChild('<p class="yui3-aquinama-item-description">'+H.get("desc")+"</p>");if(H.get("contact")){var G=C.Node.create('<div class="yui3-aquinama-item-contact"></div>');D.appendChild(G);if(H.get("contact").name){G.appendChild("<p><b>Nombre: </b>"+H.get("contact").name+"</p>");}if(H.get("contact").phone){G.appendChild("<p><b>Telefono: </b>"+H.get("contact").phone+"</p>");}if(H.get("contact").email){G.appendChild("<p><b>Correo: </b>"+H.get("contact").email+"</p>");}D.appendChild('<div class="yui3-aquinama-clear"></div>');}E._showContent();},_hideContent:function(G){var E=this,F=E.get(B),D=F.one(".yui3-aquinama-item-container");D.transition({easing:"ease-in",duration:0.25,height:0,on:{start:function(){F.one(".yui3-aquinama-item-close").addClass("yui3-aquinama-hidden");F.one(".yui3-aquinama-item-desc").removeClass("yui3-aquinama-item-bold");}}});},_showContent:function(H){var F=this,G=F.get(B),E=G.one(".yui3-aquinama-item-container"),D=E.one(".yui3-aquinama-item-container-a").get("offsetHeight");E.transition({easing:"ease-out",duration:0.25,height:D+"px",on:{end:function(){G.one(".yui3-aquinama-item-close").removeClass("yui3-aquinama-hidden");G.one(".yui3-aquinama-item-desc").addClass("yui3-aquinama-item-bold");}}});G.one(".yui3-aquinama-item-close").removeClass("yui3-aquinama-hidden");G.one(".yui3-aquinama-item-desc").addClass("yui3-aquinama-item-bold");}},{ATTRS:{emodel:{value:null},eopen:{value:false}}});C.AquiNaMa.Item=A;C.DataType.Date.convert=function(E){var D,G,F;D=new Date();F=D-E;F/=86400000;if(F<=1){return"Hoy";}else{if(F<=2){return"Ayer";}else{E=C.DataType.Date.format(E,{format:"%a %d %b"});
return E;}}};},"@VERSION@",{skinnable:true,requires:["widget","widget-child","substitute","datatype-date","transition"]});