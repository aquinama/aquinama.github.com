YUI().use("event","aquinama-datacontroller","aquinama-revolretrieve","aquinama-literal","aquinama-search","aquinama-list","aquinama-tools",function(e){var t={};var n="app.revol";n=n.split(".");e.log(n);t.tree=appTree;t.model=t.tree;t.error=error;t.Search=function(n){e.one("#yui3-aquinama-news").addClass("yui3-aquinama-hidden");e.one("#yui3-aquinama-list").removeClass("yui3-aquinama-hidden");t.list.changeMoreTex("Ver mas resultados");t.list.clearList();t.filter.clear();t.list.showLoad();t.datacontroller.resetList();e.log(n.filter);t.datacontroller.getData(n.filter);t.interest.deselect();e.one("#yui3-aquinama-error").set("innerHTML","")};t.Error=function(n){if(n.data.error.code===2){var r=t.search.get("aselect"),i=t.tree[t.search.get("aselect")];e.log("la selecionada");if(i){r=i.name}t.list.changeMoreTex(t.error[2].msg+" "+t.filter.get("query")+" "+t.list.getActiveTags()+" en "+r);t.list.hideLoad()}else{e.one("#yui3-aquinama-error").set("innerHTML","<p>"+t.error[n.data.error.code].msg)+"</p>";e.one("#yui3-aquinama-list").addClass("yui3-aquinama-hidden");t.search.clearSearch()}};t.categoryRetrieve=function(n){var r={};t.list.set("atotal",t.datacontroller.get("search.total"));t.list.set("emodellist",n.data);t.filter.set("source",t.list.source());t.filter.sendRequest();r=t.datacontroller.tags(t.search.get("aselect"));t.list.set("tags",r);t.filter.set("tags",r);t.filter.set("afilter",{});e.one("#yui3-aquinama-error").set("innerHTML","")};t.tagsHandle=function(e){t.filter.afilterPopulate(e.data);t.filter.sendRequest(t.filter.get("value"))};t.moreDataControllerHandle=function(e){t.list.set("emodellist",e.data);t.filter.set("source",t.list.source());t.filter.sendRequest(t.filter.get("query"))};t.Filter=function(e){t.list.set("evisiblelist",e.results)};t.Sort=function(e){t.filter.set("source",t.list.source());t.filter.sendRequest()};t.InterestMe=function(e){t.datacontroller.addInterest(e.model);t.interest.set("acount",t.datacontroller.get("interest").size())};t.NoInterestMe=function(e){t.datacontroller.notInterest(e.model);t.interest.set("acount",t.datacontroller.get("interest").size())};t.articleData=function(e){t.datacontroller.getData(e.data)};t.moreListHandle=function(e){t.datacontroller.more()};t.scrollDown=function(e){var n=t.body.scrollInfo.getOffscreenNodesBottom("li.yui3-aquinama-item");if(n.size()<20){t.list.moveItemsDown()}};t.search=new e.AquiNaMa.Search({boundingBox:"#yui3-aquinama-search",acategorys:t.tree});t.search.render();t.datacontroller=new e.AquiNaMa.DataController({model:t.model});t.list=new e.AquiNaMa.List({boundingBox:"#yui3-aquinama-list"});t.list.render("#yui3-aquinama-left");t.interest=new e.AquiNaMa.Interest({acount:t.datacontroller.get("interest").size(),boundingBox:e.one(".yui3-aquinama-interest"),contentBox:e.one(".yui3-aquinama-interest")});t.interest.render();t.filter=new e.AquiNaMa.Filter({inputNode:t.search.get("contentBox").one(".yui3-aquinama-search-filter"),minQueryLength:0,queryDelay:300,resultTextLocator:"tags"});t.filter.set("source",t.list.source());t.body=e.one("body");t.body.plug(e.Plugin.ScrollInfo);e.on("aquinama-search:search",t.Search);t.filter.on("results",t.Filter);e.on("aquinama-list:sort",t.Sort);e.on("aquinama-list:tags",t.tagsHandle);e.on("aquinama-datacontroller:categoryRetrieve",t.categoryRetrieve);e.on("aquinama-datacontroller:more",t.moreDataControllerHandle);e.on("aquinama-datacontroller:error",t.Error);e.on("aquinama-item:interest",t.InterestMe);e.on("aquinama-item:no-interest",t.NoInterestMe);e.on("aquinama-articlemodel:articleData",t.articleData);e.on("aquinama-list:more",t.moreListHandle);t.body.scrollInfo.on("scrollDown",t.scrollDown);e.on("aquinama-search:clear",function(n){t.list.get("boundingBox").addClass("yui3-aquinama-hidden");e.one("#yui3-aquinama-news").removeClass("yui3-aquinama-hidden");t.interest.deselect();t.list.clearList()});e.one(".yui3-aquinama-interest").on("click",function(n){e.one("#yui3-aquinama-news").addClass("yui3-aquinama-hidden");e.one("#yui3-aquinama-list").removeClass("yui3-aquinama-hidden");t.list.showLoad();t.list.set("emodellist",t.datacontroller.get("interest"));t.filter.set("source",t.list.source());t.filter.clear();t.filter.sendRequest();t.search.setCategory("Me Interesan");e.one("#yui3-aquinama-error").set("innerHTML","")})});