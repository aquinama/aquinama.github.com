YUI.add("aquinama-item",function(C){C.namespace("AquiNaMa");var B="contentBox",A=C.Base.create("aquinama-item",C.Widget,[C.WidgetChild],{CONTENT_TEMPLATE:'<li class="yui3-aquinama-item">'+'<div class="yui3-aquinama-item-title">'+'<div class="yui3-aquinama-item-control">'+'<img src="assets/images/interested.png" title="Me Interesa" class="yui3-aquinama-item-interested"/>'+'<span class="yui3-aquinama-item-date"></span>'+'<div class="yui3-aquinama-clear"></div>'+"</div>"+'<div class="yui3-aquinama-item-data">'+"</div>"+"</div>"+'<div class="yui3-aquinama-item-container yui3-aquinama-hidden">'+'<img class="yui3-aquinama-item-load" src="assets/images/ajax-loader-orange.gif"/>'+"</div>"+"</li>",initializer:function(){var D=this;D._publishEvents();},renderUI:function(){var D=this,E=D.get(B);},bindUI:function(){var D=this,F=D.get("emodel"),E=D.get(B);F.after("passfilterChange",D._handlerVisible,D);F.after("highlightChange",D.syncUI,D);D.after("emodelChange",D.syncUI);E.on("click",D._handlerClickEvent,D);E.one("img.yui3-aquinama-item-interested").on("click",D._handlerInterestEvent,D);F.after("loadChange",D._syncContent,D);},syncUI:function(){var D=this,E=D.get(B),F=D.get("emodel");D._syncTitle();D._handlerVisible();if(F.get("load")&&F.get("visible")){D._syncContent();}},_publishEvents:function(){var D=this;D.publish("interest",{emitFacade:true,broadcast:1});},_handlerInterestEvent:function(F){var D=this,E=D.get("emodel");D.fire("aquinama-item:interest",{model:E});E.set("visible",true);D.set("model",E);F.stopPropagation();D._showContent();},_handlerClickEvent:function(G){var D=this,E=D.get(B),F=D.get("emodel");if(F.get("visible")){D._hideContent();F.set("visible",false);}else{F.loadContent();F.set("visible",true);D._showContent();}D.set("model",F);},_handlerVisible:function(){var D=this,E=D.get("boundingBox"),F=D.get("emodel").get("passfilter");if(F){E.removeClass("yui3-aquinama-hidden");}else{E.addClass("yui3-aquinama-hidden");}},_syncTitle:function(I){var D=this,G=D.get("emodel"),E=D.get(B),H='<span class="yui3-aquinama-item-price">{price} cuc</span><span>{highlight}</span><div class="yui3-aquinama-clear"></div>',F=C.DataType.Date.convert(G.get("date"));H=C.substitute(H,G.toJSON());E.one(".yui3-aquinama-item-data").set("innerHTML",H);E.one(".yui3-aquinama-item-date").set("innerHTML",F);},_syncContent:function(){var D=this,F=D.get(B),K="<p>{desc}</p><p>Email: {email}</p><p>Nombre: {name}</p><p>Telefono: {phone}</p>",I=D.get("emodel"),H="",G="",E="",J;J=C.substitute(K,{desc:I.get("desc"),email:I.get("contact").email||"",name:I.get("contact").name||"",phone:I.get("contact").phone||""});F.one(".yui3-aquinama-item-container").set("innerHTML",J);D._showContent();},_hideContent:function(D){this.get(B).one(".yui3-aquinama-item-container").addClass("yui3-aquinama-hidden");},_showContent:function(D){this.get(B).one(".yui3-aquinama-item-container").removeClass("yui3-aquinama-hidden");}},{ATTRS:{emodel:{value:null},eopen:{value:false}}});C.AquiNaMa.Item=A;C.DataType.Date.convert=function(E){var D,G,F;D=new Date();F=D-E;F/=86400000;if(F<=1){return"Hoy";}else{if(F<=2){return"Ayer";}else{E=C.DataType.Date.format(E,{format:"%a %d %b"});return E;}}};},"@VERSION@",{skinnable:true,requires:["widget","widget-child","substitute","datatype-date"]});